{"version":3,"file":"index-B5CEYwAL.js","sources":["../../node_modules/.pnpm/cc-gram@file+../node_modules/cc-gram/dist/index.esm.js","../../src/hooks/use-filters.ts","../../src/hooks/use-download-filter-image.ts","../../src/components/Preview/index.tsx"],"sourcesContent":["const t=new Map([[\"aden\",{\"hue-rotate\":-20,contrast:.9,brightness:1.2,saturate:.85}],[\"inkwell\",{sepia:.3,contrast:1.1,brightness:1.1,grayscale:1}],[\"reyes\",{sepia:.22,contrast:.85,brightness:1.1,saturate:.75}],[\"gingham\",{\"hue-rotate\":-10,brightness:1.05}],[\"toaster\",{contrast:1.5,brightness:.9}],[\"walden\",{\"hue-rotate\":-10,brightness:1.1,sepia:.3,saturate:1.6}],[\"hudson\",{brightness:1.2,contrast:.9,saturate:1.1}],[\"earlybird\",{contrast:.9,sepia:.2}],[\"mayfair\",{contrast:1.1,saturate:1.1}],[\"lofi\",{contrast:1.5,saturate:1.1}],[\"1977\",{contrast:1.1,brightness:1.1,saturate:1.3}],[\"brooklyn\",{contrast:.9,brightness:1.1}],[\"xpro2\",{sepia:.3}],[\"nashville\",{contrast:1.2,brightness:1.05,saturate:1.2,sepia:.2}],[\"lark\",{contrast:.9}],[\"moon\",{brightness:1.1,contrast:1.1,grayscale:1}],[\"clarendon\",{contrast:1.2,saturate:1.35}],[\"willow\",{contrast:.95,brightness:.9,grayscale:.5}],[\"rise\",{contrast:.9,brightness:1.05,sepia:.2,saturate:.9}],[\"slumber\",{brightness:1.05,saturate:.66}],[\"brannan\",{contrast:1.4,sepia:.5}],[\"valencia\",{contrast:1.08,brightness:1.08,sepia:.08}],[\"maven\",{contrast:.95,brightness:1.95,saturate:1.5,sepia:.25}],[\"stinson\",{contrast:.75,brightness:1.15,saturate:.85}],[\"amaro\",{\"hue-rotate\":-10,contrast:.9,brightness:1.1,saturate:1.5}]]),e=\"undefined\"!=typeof OffscreenCanvas;function r(t,e=\"internal error.\"){if(!t)throw Error(`[CCgram] ${e}`)}function a(t){r(t&&\"IMG\"===t.tagName,\"The first argument is required and must be an <img> element.\"),r(t.src,\"The <img> element src attribute is empty.\")}function s({data:t}){const{canvas:e,image:r,filterStyle:a,options:s}=t,n=e.getContext(\"2d\",{alpha:!1});if(!n)throw new Error(\"The 2d context canvas is not supported.\");return n.filter=a,n.drawImage(r,0,0),e.convertToBlob(s)}const n=\"filter\";class i{static DEFAULT_DATA_ATTRIBUTE=n;static DEFAULT_FILTERS=t;_filters=t;_dataAttribute;_dataAttributeKey;constructor({dataAttribute:t=n,init:e=!0}={}){if(this._dataAttribute=t,this._dataAttributeKey=t.replace(/-./g,t=>t[1]?t[1].toUpperCase():\"\"),!e)return;if(\"complete\"===document.readyState)return void this.applyFilter();const r=()=>{this.applyFilter(),document.removeEventListener(\"DOMContentLoaded\",r)};document.addEventListener(\"DOMContentLoaded\",r)}get filterNames(){return[...this._filters.keys()]}setFilter(t,e){this._filters.set(t,e)}removeFilter(t){return this._filters.delete(t)}getFilterSetting(t=\"\"){return this._filters.get(t)}getFilterStyle(t=\"\"){return function(t){return t?Object.keys(t).map(e=>`${e}(${t[e]}${\"hue-rotate\"===e?\"deg\":\"blur\"===e?\"px\":\"\"})`).join(\" \"):\"none\"}(this._filters.get(t))}applyFilter(t=`img[data-${this._dataAttribute}]`){document.querySelectorAll(t).forEach(t=>{const{dataset:e}=t;t.style.setProperty(\"filter\",this.getFilterStyle(e[this._dataAttributeKey]))})}async getDataURL(t,e={}){a(t);const r=await this.getBlob(t,e);if(!r)return null;const s=new FileReader;return new Promise(t=>{s.addEventListener(\"load\",()=>{t(s.result)}),s.readAsDataURL(r)})}async getBlob(t,r={}){a(t);const{naturalWidth:n,naturalHeight:i}=t,o=r.filter??t.dataset[this._dataAttributeKey],c=this.getFilterStyle(o);if(e){const e=new OffscreenCanvas(n,i),a=await createImageBitmap(t);return new Promise(t=>{const n=function(t){const e=`\\n    const work = ${t.toString()};\\n\\n    addEventListener('message', async (...params) => {\\n      const res = await work(...params);\\n      postMessage(res);\\n    });\\n  `,r=URL.createObjectURL(new Blob([e],{type:\"text/javascript\"})),a=new Worker(r),{terminate:s}=a;return a.terminate=()=>{URL.revokeObjectURL(r),s.call(a)},a}(s);n.addEventListener(\"message\",({data:e})=>{t(e),n.terminate()}),n.postMessage({canvas:e,image:a,filterStyle:c,options:r},[e,a])})}const l=document.createElement(\"canvas\");l.width=n,l.height=i;const u=l.getContext(\"2d\",{alpha:!1});if(!u)throw new Error(\"The 2d context canvas is not supported.\");u.filter=c,u.drawImage(t,0,0);const{type:d,quality:g}=r;return new Promise(t=>l.toBlob(e=>t(e),d,g))}}const o=i,c=i;function l(t){return new c(t)}export{o as CCGram,i as CCgram,n as DEFAULT_DATA_ATTRIBUTE,t as DEFAULT_FILTERS,c as Filter,l as createFilter,c as default};\n","import { useState, useEffect } from 'react';\nimport { createFilter, FilterInstance } from 'cc-gram';\n\ninterface useFiltersOptions {\n  initialFilterName?: string;\n}\n\nexport const useFilters = ({\n  initialFilterName = '',\n}: useFiltersOptions = {}): {\n  selectedFilterName: string;\n  setSelectedFilterName: React.Dispatch<React.SetStateAction<string>>;\n  filter: FilterInstance;\n} => {\n  const [selectedFilterName, setSelectedFilterName] = useState(initialFilterName);\n\n  const filter = createFilter({ init: false });\n\n  useEffect(() => {\n    filter.applyFilter();\n  }, [selectedFilterName, filter]);\n\n  return {\n    selectedFilterName,\n    setSelectedFilterName,\n    filter,\n  };\n};\n\nexport default useFilters;\n","import { useRef } from 'react';\nimport { FilterInstance } from 'cc-gram';\n\ninterface UseDownloadFilterImageOptions {\n  downloadFileName?: string;\n  filter: FilterInstance;\n}\n\ninterface DownloadOptions {\n  downloadFileName?: string\n}\n\nexport const useDownloadFilterImage = ({ filter }: UseDownloadFilterImageOptions): {\n  imageRef: React.RefObject<HTMLImageElement>;\n  download(downloadOptions: DownloadOptions): Promise<void>;\n} => {\n  const imageRef = useRef<HTMLImageElement>(null);\n\n  const download = async ({\n    downloadFileName = 'download',\n  } = {}) => {\n    const { current } = imageRef;\n    if (!current || !(current instanceof HTMLImageElement)) throw new TypeError('ref must be an image');\n\n    const a = document.createElement('a');\n    a.href = await filter.getDataURL(current, { type: 'image/jpeg' }) || '';\n    a.download = downloadFileName;\n    a.click();\n  };\n\n  return { imageRef, download };\n};\n\nexport default useDownloadFilterImage;\n","import React from 'react';\n\nimport './Preview.scss';\n\nimport { useFilters, useDownloadFilterImage } from '../../hooks';\n\ninterface PreviewProps {\n  imageURL?: string;\n  onClear?: (event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void\n}\n\nexport const Preview: React.FC<PreviewProps> = ({\n  imageURL,\n  onClear,\n}) => {\n  const { filter, selectedFilterName, setSelectedFilterName } = useFilters();\n  const { imageRef, download } = useDownloadFilterImage({ filter });\n\n  if (!imageURL) return null;\n\n  return (\n    <div className=\"preview\">\n      <div className=\"image-container\">\n        <img\n          id=\"preview-image\"\n          src={imageURL}\n          data-filter={selectedFilterName}\n          alt={selectedFilterName.toUpperCase()}\n          ref={imageRef}\n        />\n        <button\n          type=\"button\"\n          className=\"btn btn-cross\"\n          onClick={onClear}\n          aria-label=\"Clear image\"\n        >\n          <i className=\"fa fa-times\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"btn btn-download\"\n          onClick={() => download({ downloadFileName: selectedFilterName })}\n          aria-label=\"Download image\"\n        >\n          <i className=\"fas fa-cloud-download-alt\" />\n        </button>\n      </div>\n\n      <div className=\"filters-container\">\n        {\n          filter.filterNames.map((filterName: string) => (\n            <figure\n              role=\"button\"\n              className={selectedFilterName === filterName ? 'selected' : ''}\n              key={filterName}\n              onClick={() => setSelectedFilterName(filterName)}\n              onKeyPress={() => setSelectedFilterName(filterName)}\n            >\n              <img\n                src={imageURL}\n                data-filter={filterName}\n                alt={filterName.toUpperCase()}\n              />\n              <figcaption>{filterName.toUpperCase()}</figcaption>\n            </figure>\n          ))\n        }\n      </div>\n    </div>\n  );\n};\n\nexport default Preview;\n"],"names":["t","e","r","a","s","n","i","__publicField","o","l","u","d","g","c","useFilters","initialFilterName","selectedFilterName","setSelectedFilterName","useState","filter","createFilter","useEffect","useDownloadFilterImage","imageRef","useRef","downloadFileName","current","Preview","imageURL","onClear","download","jsxs","jsx","filterName"],"mappings":"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","x_google_ignoreList":[0]}